<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Introduction of zero-shot classification using chat data | Adelson de Araujo’s blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Introduction of zero-shot classification using chat data" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Tutorials and positions on science communication, machine learning and AI-based decision making." />
<meta property="og:description" content="Tutorials and positions on science communication, machine learning and AI-based decision making." />
<link rel="canonical" href="https://adaj.github.io/blog/2021/12/12/Introduction-of-zero-shot-classification-using-chat-data.html" />
<meta property="og:url" content="https://adaj.github.io/blog/2021/12/12/Introduction-of-zero-shot-classification-using-chat-data.html" />
<meta property="og:site_name" content="Adelson de Araujo’s blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-12-12T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://adaj.github.io/blog/2021/12/12/Introduction-of-zero-shot-classification-using-chat-data.html","@type":"BlogPosting","headline":"Introduction of zero-shot classification using chat data","dateModified":"2021-12-12T00:00:00-06:00","datePublished":"2021-12-12T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://adaj.github.io/blog/2021/12/12/Introduction-of-zero-shot-classification-using-chat-data.html"},"description":"Tutorials and positions on science communication, machine learning and AI-based decision making.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://adaj.github.io/blog/feed.xml" title="Adelson de Araujo's blog" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Adelson de Araujo&#39;s blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Introduction of zero-shot classification using chat data</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-12-12T00:00:00-06:00" itemprop="datePublished">
        Dec 12, 2021
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      7 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/adaj/blog/tree/master/_notebooks/2021-12-12-Introduction-of-zero-shot-classification-using-chat-data.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/adaj/blog/master?filepath=_notebooks%2F2021-12-12-Introduction-of-zero-shot-classification-using-chat-data.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/adaj/blog/blob/master/_notebooks/2021-12-12-Introduction-of-zero-shot-classification-using-chat-data.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-12-12-Introduction-of-zero-shot-classification-using-chat-data.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this notebook, I would like to make a rapid introduction to zero-shot classification for practitioners. We will cover what it is and explore a use case. After being positively surprised with my toy examples, I prepared this notebook. I wanted to share what I see as a potentially game-changing technique to apply machine learning when ground-truth labels are unavailable or are costly to be collected.</p>
<p>This is not a comprehensive tutorial, nor does it discuss efficient approaches. Still, it's more like a taste of zero-shot classification in practice for those with no experience with it. In the conclusion, I mention some takeaways that I see on how zero-shot classification cal help in feature engineering pipelines, since you can use its output of intermediary variables to other systems. These intermediary variables are arguably more explainable since you chose the candidate labels, and you can use them in simpler models that other people can scrutinize.</p>
<p>For now, go to the example #1 below!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Imports-and-utilities">Imports and utilities<a class="anchor-link" href="#Imports-and-utilities"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoTokenizer</span><span class="p">,</span> <span class="n">pipeline</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoModelForSeq2SeqLM</span>
<span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">AutoModelForSequenceClassification</span>

<span class="k">def</span> <span class="nf">zeroshot_classifier</span><span class="p">():</span>
    <span class="c1"># Only works with English text</span>
    <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span>\
                    <span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;facebook/bart-large-mnli&quot;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForSequenceClassification</span>\
                    <span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;facebook/bart-large-mnli&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pipeline</span><span class="p">(</span><span class="n">task</span><span class="o">=</span><span class="s1">&#39;zero-shot-classification&#39;</span><span class="p">,</span>
                    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">)</span>


<span class="c1"># we will need in the second example</span>
<span class="k">def</span> <span class="nf">translator</span><span class="p">(</span><span class="n">src</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dest</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">src</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">dest</span> <span class="o">=</span> <span class="n">dest</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">tokenizer</span> <span class="o">=</span> <span class="n">AutoTokenizer</span>\
                    <span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Helsinki-NLP/opus-mt-</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">dest</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForSeq2SeqLM</span>\
                    <span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Helsinki-NLP/opus-mt-</span><span class="si">{</span><span class="n">src</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">dest</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pipeline</span><span class="p">(</span><span class="n">task</span><span class="o">=</span><span class="s1">&#39;translation&#39;</span><span class="p">,</span>
                    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-#1:-Reasoning-or-personal-impression?">Example #1: Reasoning or personal impression?<a class="anchor-link" href="#Example-#1:-Reasoning-or-personal-impression?"> </a></h2><p>This is an example taken from <a href="https://dl.acm.org/doi/pdf/10.1145/3231644.3231655">Fiacco &amp; Rosé (2018)</a>.</p>
<p>Suppose you want to classify a text as a <strong><em>causal reasoning</em></strong>, a <strong><em>evaluation reasoning</em></strong> or a <strong><em>personal impression</em></strong>.</p>
<p>If someone says</p>
<ul>
<li>"Use of coal increases pollution", we expect the label to be <strong><em>causal reasoning</em></strong>.</li>
<li>"Use of wind power may not be reliable throughtout the year", we expect the label to be <strong><em>evaluation reasoning</em></strong>.</li>
<li>"I prefer coal power", we expect the label to be <strong><em>personal impression</em></strong>.</li>
</ul>
<p>Of course, these are not completely exclusive classes and could be better conceived to be exclusive, but suppose these are exclusive.</p>
<p>We can use a pre-trained model that is able to perform zero-shot learning and generate labels without any previous training data:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipe</span> <span class="o">=</span> <span class="n">zeroshot_classifier</span><span class="p">()</span>

<span class="n">candidate_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;causal reasoning&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;evaluation reasoning&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;personal impression&#39;</span><span class="p">]</span>

<span class="n">input_texts</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Use of coal increases pollution&quot;</span><span class="p">,</span> 
              <span class="s2">&quot;Use of wind power may not be reliable throughout the year&quot;</span><span class="p">,</span>
              <span class="s2">&quot;I prefer coal power&quot;</span><span class="p">]</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">(</span><span class="n">input_texts</span><span class="p">,</span> 
                       <span class="n">candidate_labels</span><span class="o">=</span><span class="n">candidate_labels</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Okay,-I-want-to-know-more.-What-is-zero-shot-classification?">Okay, I want to know more. What is zero-shot classification?<a class="anchor-link" href="#Okay,-I-want-to-know-more.-What-is-zero-shot-classification?"> </a></h2><p>To be more accurate, zero-shot classification refers to the inference part of zero-shot learning, which is currently a hot research topic in ML literature of transer learning.</p>
<p>As good overview of what this is, <a href="https://qr.ae/pGl1ss">Ian Goodfellow's wrote in Quora the following answer</a>.</p>

<pre><code>Zero-shot learning is being able to solve a task despite not having received any training examples of that task.</code></pre>
<p>He answered the question quite some time ago, so this is not a new thing. In Wikipedia, you will see that this has been researched at least since 2008.</p>
<p>Further, Joe Davison wrote <a href="https://joeddav.github.io/blog/2020/05/29/ZSL.html">a comprehensive blog post</a> about zero-shot learning, where he greatly explains successes in the field of transfer learning that allowed models to perform surprisingly well in several classification tasks.</p>
<h2 id="Why-I-have-not-hearded-about-this-before?">Why I have not hearded about this before?<a class="anchor-link" href="#Why-I-have-not-hearded-about-this-before?"> </a></h2><p>A more accessible use of zero-shot classification (inference) for NLP practitioners has been materialized more recently particularly by the HuggingFace's <a href="https://huggingface.co/docs/transformers/index">transformers</a> library and the <a href="https://huggingface.co/models">models</a> page. New models are being proposed given that more interesting, robust, and semantically transferable <a href="https://huggingface.co/datasets">datasets</a> are available. More people are using pre-trained models and engaging in transfer learning pipelines.</p>
<h2 id="Okay,-but-labeling-without-training-samples-is-really-doable?">Okay, but labeling without training samples is really doable?<a class="anchor-link" href="#Okay,-but-labeling-without-training-samples-is-really-doable?"> </a></h2><p>Zero-shot learning is a particular form of transfer learning. That there are different ways to do the job, and techniques vary in computer vision and NLP. Of course, I still want to see more studies discussing interrater reliability with these kind of tools in a diverse set of scenarios to have a stronger argument on using it "in the wild".</p>
<p>In this notebook, we will walk through how you can put your hands in some unlabeled text data and label it automatically using models available from HuggingFace's <code>transformers</code>.</p>
<h2 id="Do-you-know-exactly-how/why-does-this-work?">Do you know exactly how/why does this work?<a class="anchor-link" href="#Do-you-know-exactly-how/why-does-this-work?"> </a></h2><p>I guess this answer depends a bit on the model you are using. Below, we test the BART model trained by facebook, and I suggest you read the <a href="https://huggingface.co/facebook/bart-large-mnli">description of the model</a> we are using here. They answer this question quite clearly, but you must have known what "NLI" is.</p>
<p>If you want to read my own (shorter) explanation of their explanation, here it is:</p>
<p>NLI stands for Natural Language Inference, and it refers to a particular classification task. Suppose two pieces of texts, a premise, and a hypothesis. The option of labels are <em>entailment</em> (when the hypothesis confirms the premise), <em>contradiction</em> (when the hypothesis denies the premise), and <em>neutral</em>. Check some examples [here]. There are some NLI datasets available; for example, SNLI and <a href="https://cims.nyu.edu/~sbowman/multinli/">MultiNLI</a> are the most famous ones I know of. Some people also call NLI's task the entailment classification task.</p>
<p>The MultiNLI dataset is enormous and enables robust algorithm architectures to produce very good models that can be transferred to other semantically similar tasks.</p>
<h2 id="But-how-does-models-trained-on-NLI-works-for-zero-shot-classification?">But how does models trained on NLI works for zero-shot classification?<a class="anchor-link" href="#But-how-does-models-trained-on-NLI-works-for-zero-shot-classification?"> </a></h2><p>With the entailment, neutral, and contradiction classes to match two pieces of text (premise and hypothesis), a lot of other classification tasks can be adapted to be semantically similar. For example, you can take an arbitrary input text and consider it as the premise. For each <code>item</code> in <code>candidate_labels</code> you want to explore with zero-shot, you create a hypothesis "This sentence is about <code>{item}</code>". Suppose that your model does a great job at the entailment task. If the model predict that relation as an entailment, that indicates a good match between your input text and this label. Would that make sense?</p>
<p>Let's go through another example to see it in action again, but in a more challenging context.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-#2:-DOTA-2-in-game-chats">Example #2: DOTA-2 in-game chats<a class="anchor-link" href="#Example-#2:-DOTA-2-in-game-chats"> </a></h2><p>If you want to go through a second example, I will use some data from DOTA-2 chats to classify them as one of the following <code>candidate_labels = ['chitchat', 'game features', 'coordination', 'toxic offense', 'gender discrimination', 'religious intolerance', 'racism']</code>. This data is in Russian, so we have a translation step in between that we may loose some information. Also we are not carrying too much in preprocessing steps, but they are indeed required for more serious projects. Also, it seems that there are zero-shot models in a few other languages available out there, such as French, Spanish, German, even Russian. See a list from HuggingFace <a href="https://huggingface.co/models?pipeline_tag=zero-shot-classification&amp;sort=downloads">models</a>.</p>
<h3 id="a.-Load-the-data">a. Load the data<a class="anchor-link" href="#a.-Load-the-data"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/kaggle/input/gosuai-dota-2-game-chats/dota2_chat_messages.csv&#39;</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean length of text&#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">df_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="b.-Translate-to-English">b. Translate to English<a class="anchor-link" href="#b.-Translate-to-English"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">translate</span> <span class="o">=</span> <span class="n">translator</span><span class="p">(</span><span class="s1">&#39;ru&#39;</span><span class="p">,</span> <span class="s1">&#39;en&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">translated_text</span> <span class="o">=</span> <span class="n">translate</span><span class="p">([</span><span class="n">t</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">])])</span>
<span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;text_en&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="p">[</span><span class="s1">&#39;translation_text&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">translated_text</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_sample</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="c.-Load-zero-shot-classifier-from-Huggingface's-transformers-library">c. Load zero-shot classifier from Huggingface's transformers library<a class="anchor-link" href="#c.-Load-zero-shot-classifier-from-Huggingface's-transformers-library"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">candidate_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chitchat&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;game features&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;coordination&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;toxic offense&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;gender discrimination&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;religious intolerance&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;racism&#39;</span><span class="p">]</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">zeroshot_classifier</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="d.-Generate-and-explore-predictions">d. Generate and explore predictions<a class="anchor-link" href="#d.-Generate-and-explore-predictions"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">pipe</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df_sample</span><span class="p">[</span><span class="s1">&#39;text_en&#39;</span><span class="p">]),</span> 
                       <span class="n">candidate_labels</span><span class="o">=</span><span class="n">candidate_labels</span><span class="p">)</span>
<span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Concluding-remarks">Concluding remarks<a class="anchor-link" href="#Concluding-remarks"> </a></h2><p>In case you want to know more about zero-shot learning, I encourage you to go through the following material:</p>
<ul>
<li><a href="https://joeddav.github.io/blog/2020/05/29/ZSL.html">https://joeddav.github.io/blog/2020/05/29/ZSL.html</a></li>
<li><a href="https://arxiv.org/abs/1909.00161">https://arxiv.org/abs/1909.00161</a></li>
<li><a href="https://www.deeplearningbook.org/contents/representation.html">https://www.deeplearningbook.org/contents/representation.html</a> (Section 15.2)</li>
<li><a href="https://www.aaai.org/Papers/AAAI/2008/AAAI08-132.pdf">https://www.aaai.org/Papers/AAAI/2008/AAAI08-132.pdf</a></li>
</ul>
<p>As a takeaway, I think a well-designed zero-shot classifier (with suitable candidate labels) can be a game-changing tool for several AI projects.</p>
<p>One use case is, for example, "expert systems," where you generate these output probabilities for classes that you understand as intermediary features that you provide to a rule-based decision-making mechanism. Then you can write things like "if causal_reasoning is high, do the action A; if evaluation_reasoning is high, do the action B." There has been some research opportunity with zero-shot learning as a feature engineering step because of this kind of system. Interestingly, one can automate understandable features computed from black-box models. Also, if you build <code>candidate_labels</code> using some theory is great because you have more evidence to back up design choices.</p>
<p>The main issue I see with this is how we can evaluate if the zero-shot labels are suitable. Well, one way to measure is by letting the model compute several labels, and then you or another person can label manually. With your labels and the zero-shot ones, you can use Cohen's Kappa as your agreement level. That, however, is not scalable when you are testing several <code>candidate_labels</code>.</p>
<p>If you see interesting use cases for zero-shot learning or want to interact/discuss this notebook, please comment below!!</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/blog/2021/12/12/Introduction-of-zero-shot-classification-using-chat-data.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Tutorials and positions on science communication, machine learning and AI-based decision making.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/adaj" target="_blank" title="adaj"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/adelsondearaujo" target="_blank" title="adelsondearaujo"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
